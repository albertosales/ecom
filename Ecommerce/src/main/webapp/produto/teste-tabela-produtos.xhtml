<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite">
    <head>
        <title>TODO supply a title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" href="../resources/css/bootstrap.css"/>
        <link rel="stylesheet" href="../resources/css/cssLayout.css"/>
        <link rel="stylesheet" href="../resources/css/default.css"/>
    </head>
    <body>
        <div>Testanddoo</div>

        <h:form acceptcharset="ISO-8859-1">
            <p:dataTable value="#{produtoService.listaProdutos}" sortMode="multiple" rows="25" paginator="true"
                         var="produtovo">
                <f:facet name="header">
                    <h:outputText value="Produtos"/>
                </f:facet>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Código" />
                    </f:facet>
                    <h:outputText value="#{produtovo.id}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Nome" />
                    </f:facet>
                    <h:outputText value="#{produtovo.nome}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Foto" />
                    </f:facet>
                    <h:outputText value="#{produtovo.foto}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Preço" />
                    </f:facet>
                    <h:outputText value="#{produtovo.preco}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Grupo" />
                    </f:facet>
                    <h:outputText value="#{produtovo.grupo.nome}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <p:commandButton 
                            action="/produto/teste-tabela-produtos.xhtml" icon="ui-icon-plus" value="Alterar Produto">
                        </p:commandButton>
                    </f:facet>
                    <p:commandButton
                        action="#{produtoService.preparaAlteracao(entity)}" icon="ui-icon-pencil" value="Alerar Produto">
                        <f:setPropertyActionListener value="#{produtovo}"
                                                     target="#{produtoService.produtovo}"/>                             

                    </p:commandButton>
                    <p:commandButton 
                        action="#{produtoService.delete(id)}" icon="ui-icon-close" value="Remover Produto">
                        <f:setPropertyActionListener value="#{produtovo}"
                                                     target="#{produtoService.produtovo}"/>                             

                    </p:commandButton>
                </p:column>


            </p:dataTable>    
        </h:form>

        <h:form acceptcharset="ISO-8859-1" enctype="multipart/form-data" >
            <p:messages id="messages" closable="true"/>
            <h:inputHidden value="#{produtoService.produtovo.id}"/>

            <p:panel header="Cadastro de Produto">
                <h:panelGrid columns="2">

                    <h:outputLabel value="Nome: " for="nome"/>
                    <p:inputText id="nome" size="50"
                                 value="#{produtoService.produtovo.nome}"
                                 required="true"
                                 requiredMessage="É necessário informar o nome do produto."/>

                    <h:outputLabel value="Foto: " for="foto"/>
                    <p:inputText id="foto" size="10"
                                 value="#{produtoService.produtovo.foto}"/>

                    <h:outputLabel value="Preço: " for="preco"/>
                    <p:inputText id="preco" size="10"
                                 value="#{produtoService.produtovo.preco}"/>

                    <h:outputLabel value="Grupo: " for="grupo"/>

                    <p:selectOneMenu id="grupo" value="#{produtoService.grupoid}"
                                     filter="true" filterMatchMode="contains">  
                        <f:selectItem itemLabel="Selecione" 
                                      noSelectionOption="true" />  
                        <f:selectItems value="#{grupoProdutoService.listaGrupos}" var="grupo" 
                                       itemLabel="#{grupo.nome}" 
                                       itemValue="#{grupo.id}"/> 
                    </p:selectOneMenu> 


                </h:panelGrid>


                <h:outputLabel value="Escolher Imagem " for="imagem"/>
                <p:fileUpload value="#{produtoService.file}" mode="simple" skinSimple="true"/>                     
                <p:fileUpload id="upload"
                              fileUploadListener="#{produtoService.uploadAction}" mode="advanced" dragDropSupport="false"
                              update="messages" sizeLimit="100000" fileLimit="3" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" />

                <p:panel> 
                    <p:commandButton ajax="false"
                                     value="Salvar"
                                     action="#{produtoService.persist(entity)}"/>
                    <p:commandButton value="Cancelar"
                                     type="reset"/>
                </p:panel>

            </p:panel>



        </h:form>

    </body>
</html>
